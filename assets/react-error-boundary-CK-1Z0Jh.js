import{r as n}from"./index-23bTMWg6.js";const l=n.createContext(null),c={didCatch:!1,error:null};class h extends n.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=c}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(...e){const{error:t}=this.state;t!==null&&(this.props.onReset?.({args:e,reason:"imperative-api"}),this.setState(c))}componentDidCatch(e,t){this.props.onError?.(e,t)}componentDidUpdate(e,t){const{didCatch:o}=this.state,{resetKeys:s}=this.props;o&&t.error!==null&&f(e.resetKeys,s)&&(this.props.onReset?.({next:s,prev:e.resetKeys,reason:"keys"}),this.setState(c))}render(){const{children:e,fallbackRender:t,FallbackComponent:o,fallback:s}=this.props,{didCatch:a,error:i}=this.state;let u=e;if(a){const d={error:i,resetErrorBoundary:this.resetErrorBoundary};if(typeof t=="function")u=t(d);else if(o)u=n.createElement(o,d);else if(s!==void 0)u=s;else throw i}return n.createElement(l.Provider,{value:{didCatch:a,error:i,resetErrorBoundary:this.resetErrorBoundary}},u)}}function f(r=[],e=[]){return r.length!==e.length||r.some((t,o)=>!Object.is(t,e[o]))}function p(r){return r!==null&&typeof r=="object"&&"didCatch"in r&&typeof r.didCatch=="boolean"&&"error"in r&&"resetErrorBoundary"in r&&typeof r.resetErrorBoundary=="function"}function y(r){if(!p(r))throw new Error("ErrorBoundaryContext not found")}function m(){const r=n.useContext(l);y(r);const{error:e,resetErrorBoundary:t}=r,[o,s]=n.useState({error:null,hasError:!1}),a=n.useMemo(()=>({error:e,resetBoundary:()=>{t(),s({error:null,hasError:!1})},showBoundary:i=>s({error:i,hasError:!0})}),[e,t]);if(o.hasError)throw o.error;return a}function B(r){switch(typeof r){case"object":{if(r!==null&&"message"in r&&typeof r.message=="string")return r.message;break}case"string":return r}}function C(r,e){const t=n.forwardRef((s,a)=>n.createElement(h,e,n.createElement(r,{...s,ref:a}))),o=r.displayName||r.name||"Unknown";return t.displayName=`withErrorBoundary(${o})`,t}export{h as ErrorBoundary,l as ErrorBoundaryContext,B as getErrorMessage,m as useErrorBoundary,C as withErrorBoundary};
